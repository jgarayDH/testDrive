<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <section id="challenge">
      <!--
    Challenge X: In this section, we have a list of post containers. The goal is
    to emulate a network request, populating each of the containers with two
    elements, a title and a content, attaching a custom 'onLoaded' event to each
    post container and raising it once the data has been added. To make the
    loading behavior more obvious, you will need to randomly add a delay before each
    post load, allowing a maximum of 10 seconds of wait time. The animation
    should also consist of two elements, an image and a text.
    Complete the rest of the code making use of the 'showLoadingAnimation'
    function without altering it.
    Image and texts samples are provided below. Use the reference video to have
    a better understanding of the final result.

    Post title: 'Title'
    Post content: 'Lorem, ipsum dolor sit amet consectetur adipisicing elit. Natus nemo ipsum optio quae commodi modi velit eius ipsam nihil explicabo, quisquam quos eum cum obcaecati minus, provident fugit, illo repudiandae.'
    Loading image: 'https://upload.wikimedia.org/wikipedia/commons/c/c9/SVG_animated_loading_icon.svg'
    Loading text: 'Loading...'

    Reference video: https://giphy.com/gifs/irSpw9J7OuIWvjVS6J
  -->

      <style>
        .c4-container {
          margin: 50px auto;
          max-width: 800px;
          width: 100%;
        }
      </style>

      <!-- do not change the markup -->
      <div class="c4-container">
        <div class="post"></div>
        <hr />

        <div class="post"></div>
        <hr />

        <div class="post"></div>
        <hr />

        <div class="post"></div>
        <hr />

        <div class="post"></div>
      </div>

      <script>
        const posts = document.querySelectorAll("div.post");

        const post = {
          title: "Title",
          content:
            "Lorem, ipsum dolor sit amet consectetur adipisicing elit. Natus nemo ipsum optio quae commodi modi velit eius ipsam nihil explicabo, quisquam quos eum cum obcaecati minus, provident fugit, illo repudiandae.",
        };

        function showLoadingAnimation(posts, animationElement) {
          posts.forEach((postContainer) => {
            //Random Time to load
            const loadingDelay = Math.random() * 10000;

            setTimeout(() => {
              const title = document.createElement("h1");
              title.textContent = post.title;

              const content = document.createElement("p");
              content.textContent = post.content;

              const animationClone = animationElement().cloneNode(true);
              postContainer.appendChild(title);
              postContainer.appendChild(content);
              postContainer.appendChild(animationClone);

              setTimeout(() => {
                postContainer.removeChild(animationClone);
                postContainer.dispatchEvent(new Event("onLoaded"));
              }, 1000);
            }, loadingDelay);
          });
        }

        function loadingAnimation() {
          const loadImg = document.createElement("img");
          loadImg.src =
            "https://upload.wikimedia.org/wikipedia/commons/c/c9/SVG_animated_loading_icon.svg";
          loadImg.alt = "Loading Image";

          const loadingText = document.createElement("p");
          loadingText.textContent = "Loading...";

          const animationContainer = document.createElement("div");
          animationContainer.appendChild(loadImg);
          animationContainer.appendChild(loadingText);

          return animationContainer;
        }

        // Function call
        showLoadingAnimation(posts, loadingAnimation);
      </script>
    </section>
  </body>
</html>
